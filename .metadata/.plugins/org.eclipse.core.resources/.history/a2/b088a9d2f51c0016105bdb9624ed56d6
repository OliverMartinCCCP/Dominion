package Model;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

public class WriteToMySql {
	public static void main(String args[]) throws Exception
	{
		createTable();
		post();
		get();
	}
	
	public static Connection getConnection() throws Exception
	{
		try{
			String driver = "com.mysql.jdbc.Driver";
			String url = "jdbc:mysql://localhost:3306/dominion";
			String username = "root";
			String password = "";
			Class.forName(driver);
			
			Connection com = DriverManager.getConnection(url,username,password);
			System.out.println("Connected");
			return com;
		} catch(Exception e){System.out.println(e);};
		
		return null;
	}
	
	public static void createTable() throws Exception
		{try{
			Connection com = getConnection();
			PreparedStatement create = com.prepareStatement("CREATE TABLE IF NOT EXISTS player(id int NOT NULL AUTO_INCREMENT, name varchar(255), wins int NULL DEFAULT NULL, loses int NULL DEFAULT NULL, laststep varchar(255) NULL DEFAULT NULL, PRIMARY KEY (id))");
			create.executeUpdate();	
		}catch(Exception e){System.out.println(e);}
		finally{System.out.println("function complete...");};
	}

	public static void post() throws Exception
		{
		final String var1 = "clydez";
		final int var2 = 1000;
		final int var3 = 0;
		final String var4 = "Lose";
		
		try{
			Connection com = getConnection();
			PreparedStatement posted = com.prepareStatement("INSERT INTO player (name, wins, loses, laststep) VALUES ('"+var1+"', '"+var2+"', '"+var3+"', '"+var4+"')");
			posted.executeUpdate();
		}catch(Exception e){System.out.println(e);}
		finally{
			System.out.println("Insert Completed");
		}
	}
	
	public static ArrayList<String> get() throws Exception
	{
		try{
			Connection com = getConnection();
			PreparedStatement statement = com.prepareStatement("SELECT * FROM player");
			
			ResultSet result = statement.executeQuery();
			
			ArrayList<String> array = new ArrayList<String>();
			while(result.next()){
				System.out.print(result.getString("id"));
				System.out.print(" ");
				System.out.print(result.getString("name"));
				System.out.print(" ");
				System.out.print(result.getString("wins"));
				System.out.print(" ");
				System.out.print(result.getString("loses"));
				System.out.print(" ");
				System.out.println(result.getString("laststep"));
				
				array.add(result.getString("id"));
				array.add(result.getString("name"));
				array.add(result.getString("wins"));
				array.add(result.getString("loses"));
				array.add(result.getString("laststep"));
				
			}
			System.out.println("All records have been selected");
			return array;
			
		}catch(Exception e){System.out.println(e);}
		return null;
		
	}
}